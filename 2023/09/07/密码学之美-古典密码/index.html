<!-- build time:Fri Sep 08 2023 15:49:29 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="踏雪无痕" href="https://crazyzer0.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="踏雪无痕" href="https://crazyzer0.github.io/atom.xml"><link rel="alternate" type="application/json" title="踏雪无痕" href="https://crazyzer0.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="密码学的代码实现"><link rel="canonical" href="https://crazyzer0.github.io/2023/09/07/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%8B%E7%BE%8E-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/"><title>密码学之美 -- 古典密码 - 密码学 | Small Town = 踏雪无痕</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">密码学之美 -- 古典密码</h1><div class="meta"><span class="item" title="创建时间：2023-09-07 00:38:18"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2023-09-07T00:38:18+08:00">2023-09-07</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>17k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>16 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Small Town</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giciundwu5j20zk0m8n9e.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclj9410cj20zk0m8h12.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclhfehz7j20zk0m8u0x.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicis3attqj20zk0m8k7l.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipewf5l51j20zk0m8b29.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicljitigmj20zk0m87fp.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/" itemprop="item" rel="index" title="分类于 密码学"><span itemprop="name">密码学</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://crazyzer0.github.io/2023/09/07/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%8B%E7%BE%8E-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Small Town"><meta itemprop="description" content=", 2023 & 北京 & 学习笔记"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="踏雪无痕"></span><div class="body md" itemprop="articleBody"><p>有一说一，密码学天天不去上课的我心情逐渐慌乱起来，放纵让 A5152 提前好几个月放寒假，密码学结课的日子一天天逼近，就好像寒假快要结束但是作业还没写的小学生。李鼎说，<span class="spoiler" title="你知道得太多了">” 遇到了困难，就不做了，睡大觉。”</span>“只要思想不滑坡，方法总比困难多。” 目前，性价比最高的解决路径是把握好密码学课程设计的契机。<s>所谓 “水课”，不就是用来玩的嘛</s>密码学课程设计作为信息安全专业最核心的专业实践课之一，看似枯燥无味，实则弃之有肉。在思路空白的情况下，一边预习课本一边用代码验证自己的预习成果不失为 “曲线救国” 之良策。<span class="spoiler" title="你知道得太多了">又菜又爱玩，还给自己找借口，我可真是个铁废物！</span></p><h1 id="古典密码概述"><a class="anchor" href="#古典密码概述">#</a> 古典密码概述</h1><p>经典密码体制都是对称密码体制，密钥由安全信道传递，可分为：替换密码 / 代换密码（Substitution）—— 用一个符号代替另一个符号。<br>单表替换密码：仿射密码（移位代换密码，乘数密码）；<br>多表替换密码：Playfair；Vigenère；Hill 密码。</p><h2 id="单表替换密码"><a class="anchor" href="#单表替换密码">#</a> 单表替换密码</h2><p>使用一个固定的替换表 —— 明文、密文字符一一对应。</p><h3 id="i-基于密钥的单表代换密码"><a class="anchor" href="#i-基于密钥的单表代换密码">#</a> Ⅰ 基于密钥的单表代换密码</h3><p>首先选取一个英文单词或字符串作为密钥，去掉其中重复的字母得到一个无重复字母的字母序列，然后将字母表中的其他字母按字母顺序依次写在此字母序列的后面，若密钥中字母有重复则后出现的字母不再出现，从而使所有字母建立一一对应关系，也就是字母代换表。</p><h4 class="blue" id="安全性分析"><a class="anchor" href="#安全性分析">#</a> 安全性分析</h4><p>①单表代换密码不只是 25 种可能的密钥，而是允许任意代换，增加密钥空间，这使得单表代换密码破译难度稍高，密钥更改也更加便捷，增加了单表代换体制的灵活性；</p><p>②每个明文字母可以随机映射到任意一个密文字母，密文行是 26 个字母的任意置换，那么就会有 26!=4×10^26 种可能的密钥，这比 DES 的密钥空间大 10 个数量级，看起来是安全的，可以抵御穷尽攻击，其实不然，这是因为语言的一些规律和特性；</p><p>③人类的语言是有冗余性的，每个字母使用的频率是不一样的，单表代换不能改变相关字母出现的频率，因此，只要统计密文种字母出现的频率，与已知的统计值作比较就可以分析出相应的明文字母了。</p><h3 id="ii-仿射密码affine-cipher线性同余密码"><a class="anchor" href="#ii-仿射密码affine-cipher线性同余密码">#</a> Ⅱ 仿射密码（affine cipher：线性同余密码）</h3><p>仿射密码的加密算法是一个线性变换，是移位密码和乘数密码的组合，即对任意的明文字符 x，选取 k1，k2 两个参数，其中 k1，k2∈Z26，且要求 gcd (k1，26)=1。</p><p>加密变换：C=k1*m+k2 (mod26)（当 k1=1 时，移位密码；当 k2=1 时，乘数密码）；</p><p>解密变换：m=k1^(-1)*(C-k2)(mod26)。</p><p><span class="red">注：</span>为保证仿射加密函数是一个单射函数，必须要保证 (k1，26)=1。</p><h4 class="blue" id="安全性分析-2"><a class="anchor" href="#安全性分析-2">#</a> 安全性分析</h4><p>①密钥空间：要保证 (k1，26)=1，k1 就有<em> φ</em>(26)=12 种取值；k2 可以取任意值共 26 种；当 k1=1，k2=0 时密文与密文相同，并没有实际意义，所以密钥空间为 12×26-1=311；</p><p>②相对于普通的移位密码和乘数密码，仿射密码的安全性有了一定的提高，但其密钥空间依然很小，可以考虑穷举法暴力破解仿射密码；</p><p>③仿射密码无法摆脱单表密码自身存在的弱点，在统计规律面前，参数 k1，k2 可被迅速破解，由此，仿射密码安全性极差。</p><h2 id="多表替换密码"><a class="anchor" href="#多表替换密码">#</a> 多表替换密码</h2><p>以一系列代换表依次对明文消息的字母序列进行代换的加密方法。如果代换表序列是非周期的无限序列，则相应的密码称为非周期多表代换密码，这类密码被称为一次一密密码，它是理论上不可破译的密码体制。在实际应用中经常采用的是周期多表代换密码，有限个代换表往往被重复使用，它是一种比单表密码体制更为安全的密码体制。</p><h3 id="vigenère密码"><a class="anchor" href="#vigenère密码">#</a> Vigenère 密码</h3><p>维吉尼亚密码是一种简单的多表代换密码 (由 26 个类似的 Caesar 密码的代换表组成)，即由一些偏移量不同的恺撒密码组成，这些代换在一起组成了密钥。假设串长为 m，明文为 P，密文为 C，密钥为 K，则（若密钥长度不够则可以继续重复使用密钥）</p><p>加密变换：C=(P1+K1,P2+K2,...,Pm+Km)（mod26）</p><p>解密变换 ：P=(C1-K1,C2-K2,...,Cm-Km)（mod26)</p><h4 class="blue" id="安全性分析-3"><a class="anchor" href="#安全性分析-3">#</a> 安全性分析</h4><p>①多表代换密码打破院语言的字符出现规律，故其分析方法比单表代换密码复杂得多。相对于单表代换密码，它的安全性有了显著的提高，实际应用中采用的密钥并非是一次一密，这就给维吉尼亚密码的破解提供了可能；</p><p>②维吉尼亚密码的密钥比密文的长度小，意味着加解密过程是有一定规律的，只要确定密钥长度，就可以依据统计规律的 bug 进行破译；</p><p>③破译过程存在一定的误差，密文越短误差越大，所以较短的维尼尼亚密码可以免疫统计规律，几乎不可破译。</p><h1 id="密码课程设计任务点"><a class="anchor" href="#密码课程设计任务点">#</a> 密码课程设计任务点</h1><p><img data-src="https://pic.downk.cc/item/5fe40a6f3ffa7d37b3496369.png" alt=""></p><p>任务完不完成不重要，主要是为了学知识。<span class="spoiler" title="你知道得太多了">要不是为了 3 学分，我学个 der！终究活成了自己讨厌的样子！</span></p><h1 id="c代码实现"><a class="anchor" href="#c代码实现">#</a> C++ 代码实现</h1><p>申明：C++ 代码除了维吉尼亚的破解参考了部分博客，其余皆为本人倾力亲为之作，转载请注明出处；由于本人代码能力有限，代码写得较为冗余，如果有空，我会进行综合归纳，减小算法的冗余度和复杂度过高的问题，此段旨在传达核心思想，提供代码参考，具体实现可以自行优化修改，如果出现问题，本人概不负责；为防止代码过长，思路出现混乱，此段进行分块展示加解密和破解问题。</p><h2 id="part-i-单表替换密码-仿射密码"><a class="anchor" href="#part-i-单表替换密码-仿射密码">#</a> PART Ⅰ 单表替换密码 -- 仿射密码</h2><h3 id="加密变换"><a class="anchor" href="#加密变换">#</a> 加密变换：</h3><p><img data-src="https://pic.downk.cc/item/5fe445f53ffa7d37b375712f.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe4726f3ffa7d37b3cf7064.png" alt=""></p><p>加密的功能：①基本的仿射加密完全实现，大写转成大写，小写转成小写；</p><p>②判断出 k1 与 26 不互素时利用跳转语句 goto 提示 k1 输入错误，需要重新输入；</p><p>③字母外的字母保持原来的状态，不作任何处理，按照输入的样子输出；</p><p>④利用 cin.getline () 语句和 cin.ignore () 语句，确保在 while (true) 的条件下可以反复进行加密。</p><p><img data-src="https://pic.downk.cc/item/5fe446233ffa7d37b375a0b4.png" alt=""></p><h3 id="解密变换"><a class="anchor" href="#解密变换">#</a> 解密变换：</h3><p><img data-src="https://pic.downk.cc/item/5fe450d83ffa7d37b389d346.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe451013ffa7d37b38a1af3.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe451163ffa7d37b38a4041.png" alt=""></p><p>加解密所实现的功能基本相同，对于功能不作多余赘述。在此重点介绍求模逆的方法：</p><p>①按照我的思路无脑打表，用空间换时间，反正就 12 个数，简单粗暴反应快；</p><p>②（暴力穷举法）模 26 数挺小的，考虑遍历完全剩余系，求出相应的模逆；</p><p><img data-src="https://pic.downk.cc/item/5fe4531f3ffa7d37b38e8be3.png" alt=""></p><p>③（辗转相除法）有信息安全数学基础作铺垫，可以很容易列表来求出模逆。</p><p><img data-src="https://pic.downk.cc/item/5fe4730d3ffa7d37b3d0ab6d.png" alt=""></p><h3 id="暴力穷举破解"><a class="anchor" href="#暴力穷举破解">#</a> 暴力穷举破解：</h3><p><img data-src="https://pic.downk.cc/item/5fe45aba3ffa7d37b39f6e54.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe482093ffa7d37b3ea5ae1.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe459103ffa7d37b39b39e9.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe4593a3ffa7d37b39b913f.png" alt=""></p><p>暴力穷举破解与解密算法相差无几，主要在于用 for 循环遍历所有的 k1 和 k2，但是应当排除 k1=1，k2=0 的无意义加密。<span class="red">需要注意的一点是，</span>由于采用打表法取的 k1 值，所以 k1 的取值一定与 26 互素，就不用考虑 k1 和 26 是否互素的问题。</p><h3 id="统计分析攻击仿射密码"><a class="anchor" href="#统计分析攻击仿射密码">#</a> 统计分析攻击仿射密码：</h3><p><img data-src="https://pic.downk.cc/item/5fe483123ffa7d37b3ec4b8f.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe483b73ffa7d37b3ed6229.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe4618b3ffa7d37b3addc6b.png" alt=""></p><h4 id="关于公式的推导"><a class="anchor" href="#关于公式的推导">#</a> <span class="red">关于公式的推导：</span></h4><p><img data-src="https://pic.downk.cc/item/5fe468503ffa7d37b3bbc7e4.jpg" alt=""></p><h3 id="统计分析攻击仿射密码的优化"><a class="anchor" href="#统计分析攻击仿射密码的优化">#</a> 统计分析攻击仿射密码的优化：</h3><p><img data-src="https://pic.downk.cc/item/5fe4b0253ffa7d37b339fc10.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe486713ffa7d37b3f20614.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe486be3ffa7d37b3f2949a.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe46a3c3ffa7d37b3bf6983.png" alt=""></p><h2 id="part-ii-多表替换密码-维吉尼亚密码"><a class="anchor" href="#part-ii-多表替换密码-维吉尼亚密码">#</a> PART Ⅱ 多表替换密码 -- 维吉尼亚密码</h2><h3 id="加密变换-2"><a class="anchor" href="#加密变换-2">#</a> 加密变换：</h3><p><img data-src="https://pic.downk.cc/item/5fe4c1c23ffa7d37b3569ce0.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe4c2a83ffa7d37b35811fd.png" alt=""></p><h3 id="解密变换-2"><a class="anchor" href="#解密变换-2">#</a> 解密变换：</h3><p><img data-src="https://pic.downk.cc/item/5fe4c4e13ffa7d37b35b9aff.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe4c5343ffa7d37b35c1868.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe4c5603ffa7d37b35c5c7e.png" alt=""></p><h3 id="维吉尼亚密码无密钥破解"><a class="anchor" href="#维吉尼亚密码无密钥破解">#</a> 维吉尼亚密码无密钥破解:</h3><p><img data-src="https://pic.downk.cc/item/5fe4e4813ffa7d37b38b7217.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe4e4ad3ffa7d37b38bb03c.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe4e4c33ffa7d37b38bd039.png" alt=""></p><p><img data-src="https://pic.downk.cc/item/5fe4e4d13ffa7d37b38be460.png" alt=""></p><p><strong><span class="red">计算拟重合指数判断条件的改进思路：穷举法计算出所有的拟重合指数，找出拟重合指数最接近 0.065 的时刻所对应的偏移量，从而计算出对应位置的密钥。</span></strong></p><p><img data-src="https://pic.downk.cc/item/5fe5586c3ffa7d37b3e95457.png" alt=""></p><p><ins class="dot"><span class="red">注：函数中 x/L 以及 0.065 都不是整型数 int，因此变量以及数组的定义都应当设置成 float 型，否则程序一定会 give you a surprise！在今后的学习中也务必小心这种属于逻辑语法之外的错误。</span></ins></p><p><strong><span class="red">改进拟重合指数源代码如下：</span></strong></p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre>cout<span class="token operator">&lt;&lt;</span><span class="token string">"密钥长度为:"</span><span class="token operator">&lt;&lt;</span>klen<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>klen<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">// 统计分组字母个数 </span></pre></td></tr><tr><td data-num="3"></td><td><pre>	<span class="token punctuation">&#123;</span>	</pre></td></tr><tr><td data-num="4"></td><td><pre>	<span class="token keyword">int</span> g<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// 密文移动 g 个位置 </span></pre></td></tr><tr><td data-num="5"></td><td><pre>	<span class="token keyword">float</span> temp<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 存储偏移量 </span></pre></td></tr><tr><td data-num="6"></td><td><pre>	<span class="token function">memset</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span>g<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>g<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span>g<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>		<span class="token keyword">float</span> x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// 拟重合指数 	</span></pre></td></tr><tr><td data-num="10"></td><td><pre>		<span class="token function">memset</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 盛放字母个数的数组</span></pre></td></tr><tr><td data-num="11"></td><td><pre>		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token operator">&lt;</span>clen<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>			<span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>			<span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="15"></td><td><pre>			num<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'A'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>			<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>			<span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>			<span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="19"></td><td><pre>			num<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>			<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>	    <span class="token keyword">int</span> L<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>	    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">// 子串密文长度</span></pre></td></tr><tr><td data-num="24"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>			L<span class="token operator">+=</span>num<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>			x<span class="token operator">=</span>x<span class="token operator">+</span>p<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">*</span>num<span class="token punctuation">[</span><span class="token punctuation">(</span>k<span class="token operator">+</span>g<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>	    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>	    temp<span class="token punctuation">[</span>g<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">abs</span><span class="token punctuation">(</span>x<span class="token operator">/</span>L<span class="token operator">-</span><span class="token number">0.065</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>	<span class="token keyword">float</span> value<span class="token operator">=</span>temp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="31"></td><td><pre>	<span class="token keyword">int</span> result<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span>g<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>g<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span>g<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">// 找最小偏差 </span></pre></td></tr><tr><td data-num="33"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>temp<span class="token punctuation">[</span>g<span class="token punctuation">]</span><span class="token operator">&lt;</span>value<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>		value<span class="token operator">=</span>temp<span class="token punctuation">[</span>g<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>		result<span class="token operator">=</span>g<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>		key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>result<span class="token punctuation">;</span>		</pre></td></tr><tr><td data-num="41"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"加密密钥为:"</span><span class="token punctuation">;</span></pre></td></tr></table></figure><h1 id="附源代码"><a class="anchor" href="#附源代码">#</a> 附源代码：</h1><h2 id="part-i-仿射密码"><a class="anchor" href="#part-i-仿射密码">#</a> PART Ⅰ 仿射密码</h2><p>加密变换：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> <span class="token keyword">int</span> maxn<span class="token operator">=</span><span class="token number">1e4</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">int</span> c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 将与 26 互素的所有的数打表存到数组里，确保 k1 和 26 互素 </span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// 个人认为打表会减小时间复杂度，用空间换时间 </span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// 或者使用下面的函数调用也未尝不可，算出 k1 和 26 最大公因数为 1 表示互素 </span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">//int gcd(int a,int b)&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">//    if(b==0) return a;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">//    else&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">//    if(a>=b) return gcd(b,a%b);</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">//    else return gcd(a,b%a);</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">//&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>	<span class="token keyword">int</span> k1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>	<span class="token keyword">int</span> k2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">// 加密过程的实现 </span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>	<span class="token keyword">char</span> s<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 明文块 </span></pre></td></tr><tr><td data-num="22"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"Please enter your plaintext:"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">//	cin>>s;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    cin<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>maxn<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 接受空格 </span></pre></td></tr><tr><td data-num="25"></td><td><pre>    label<span class="token operator">:</span>cout<span class="token operator">&lt;&lt;</span><span class="token string">"Please enter your k1:"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>	cin<span class="token operator">>></span>k1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">// 若 k1 与 26 不互素，则重新输入一个字符 </span></pre></td></tr><tr><td data-num="28"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">12</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>k1<span class="token operator">==</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token number">11</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token string">"You entered the wrong k1"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>		<span class="token keyword">goto</span> label<span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="35"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"Please enter your k2:"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>	cin<span class="token operator">>></span>k2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>	<span class="token keyword">int</span> len<span class="token operator">=</span><span class="token function">strlen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>	<span class="token keyword">int</span> m<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token comment">// 将字符移位操作的位数存到数组 m [maxn] 里面 </span></pre></td></tr><tr><td data-num="42"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>	<span class="token punctuation">&#123;</span>		</pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre>		m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>k1<span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'A'</span><span class="token punctuation">)</span><span class="token operator">+</span>k2<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre>		m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>k1<span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token operator">+</span>k2<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token comment">// 如果为空格或除字母外的其他字符就不进行移位操作 </span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token comment">//		cout&lt;&lt;(char)('A'+m);</span></pre></td></tr><tr><td data-num="51"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"******Encryption******"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"The ciphertext is:"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="55"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="57"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token char">'A'</span><span class="token operator">+</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="59"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token char">'a'</span><span class="token operator">+</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>		<span class="token keyword">else</span></pre></td></tr><tr><td data-num="61"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>	cin<span class="token punctuation">.</span><span class="token function">ignore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 清空输入流保证可以再次加密 </span></pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>解密变换：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 仿射密码的解密</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> <span class="token keyword">int</span> maxn<span class="token operator">=</span><span class="token number">1e4</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token keyword">int</span> c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// 与 26 互素的所有元素 </span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">// 将互素元素的模逆元素存到数组 inverse [100] 里面 </span></pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token keyword">int</span> inverse<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>	<span class="token keyword">int</span> temp<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token function">memset</span><span class="token punctuation">(</span>inverse<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>inverse<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="12"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">12</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>		inverse<span class="token punctuation">[</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span>temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>	<span class="token punctuation">&#125;</span>	 </pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// 解密过程的实现 </span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>	<span class="token keyword">int</span> k1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>	<span class="token keyword">int</span> k2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>	<span class="token keyword">char</span> s<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 密文块 </span></pre></td></tr><tr><td data-num="22"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"Please enter your ciphertext:"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">//	cin>>s;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    cin<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>maxn<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    label<span class="token operator">:</span>cout<span class="token operator">&lt;&lt;</span><span class="token string">"Please enter your k1:"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>	cin<span class="token operator">>></span>k1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">12</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>k1<span class="token operator">==</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token number">11</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token string">"You entered the wrong k1"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>		<span class="token keyword">goto</span> label<span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="34"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"Please enter your k2:"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>	cin<span class="token operator">>></span>k2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>	<span class="token keyword">int</span> len<span class="token operator">=</span><span class="token function">strlen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>	<span class="token keyword">int</span> m<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token comment">// 将字符移位操作的位数存到数组 m [maxn] 里面 	</span></pre></td></tr><tr><td data-num="41"></td><td><pre>	k1<span class="token operator">=</span>inverse<span class="token punctuation">[</span>k1<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 将 k1 的模逆赋给 k1 </span></pre></td></tr><tr><td data-num="42"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>		m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>k1<span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'A'</span><span class="token punctuation">)</span><span class="token operator">-</span>k2<span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span><span class="token comment">//+26 可以防止负数取模为负数 </span></pre></td></tr><tr><td data-num="46"></td><td><pre>		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>		m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>k1<span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token operator">-</span>k2<span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token comment">// 如果为空格或除字母外的其他字符就不进行移位操作 </span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token comment">//		cout&lt;&lt;(char)('A'+m);</span></pre></td></tr><tr><td data-num="50"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"******Decryption******"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"The plaintext is:"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="54"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="56"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token char">'A'</span><span class="token operator">+</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="58"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token char">'a'</span><span class="token operator">+</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>		<span class="token keyword">else</span></pre></td></tr><tr><td data-num="60"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>	cin<span class="token punctuation">.</span><span class="token function">ignore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>暴力穷举破解：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 仿射密码穷举法暴力破解 </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 密文推出明文 解密出有意义的内容 </span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">const</span> <span class="token keyword">int</span> maxn<span class="token operator">=</span><span class="token number">1e4</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token keyword">int</span> c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// 与 26 互素的所有元素 </span></pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token keyword">int</span> inverse<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>	<span class="token keyword">int</span> temp<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token function">memset</span><span class="token punctuation">(</span>inverse<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>inverse<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="12"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">12</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>		inverse<span class="token punctuation">[</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span>temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>	<span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// 解密过程的实现 </span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>	<span class="token keyword">int</span> k1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>	<span class="token keyword">int</span> k2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>	<span class="token keyword">char</span> s<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"Please enter your ciphertext:"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">//	cin>>s;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    cin<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>maxn<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">//  cout&lt;&lt;"please enter your k1:";</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment">//	cin>>k1;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">//	cout&lt;&lt;"please enter your k2:";</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">//	cin>>k2;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>	<span class="token keyword">int</span> len<span class="token operator">=</span><span class="token function">strlen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>	<span class="token keyword">int</span> m<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token number">12</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">&lt;=</span><span class="token number">25</span><span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token operator">&amp;&amp;</span>k<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token comment">// 考虑到 k1=1,k2=0 的无意义加密方式 </span></pre></td></tr><tr><td data-num="35"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre>		m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>inverse<span class="token punctuation">[</span>c<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'A'</span><span class="token punctuation">)</span><span class="token operator">-</span>k<span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>		m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>inverse<span class="token punctuation">[</span>c<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token operator">-</span>k<span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token comment">//		cout&lt;&lt;(char)('A'+m);</span></pre></td></tr><tr><td data-num="42"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"******Decryption******"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"k1="</span><span class="token operator">&lt;&lt;</span>c<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token string">",k2="</span><span class="token operator">&lt;&lt;</span>k<span class="token operator">&lt;&lt;</span><span class="token string">","</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"The plaintext is:"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token char">'A'</span><span class="token operator">+</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="51"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token char">'a'</span><span class="token operator">+</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>		<span class="token keyword">else</span></pre></td></tr><tr><td data-num="53"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>	cin<span class="token punctuation">.</span><span class="token function">ignore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>求模逆的小程序 ：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 求模逆的小程序 </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>	<span class="token keyword">int</span> m<span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>		cin<span class="token operator">>></span>m<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">26</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token operator">*</span>i<span class="token operator">+</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>			<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>			cout<span class="token operator">&lt;&lt;</span>m<span class="token operator">&lt;&lt;</span><span class="token string">"的模逆是："</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>			cout<span class="token operator">&lt;&lt;</span>i<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>			<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>			<span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token number">26</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>			<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>				cout<span class="token operator">&lt;&lt;</span>m<span class="token operator">&lt;&lt;</span><span class="token string">"没有模逆"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>			<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>求模逆的小程序 - 1：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 求模逆的小程序 - 1</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">int</span> <span class="token function">mod_invese</span><span class="token punctuation">(</span><span class="token keyword">int</span> d<span class="token punctuation">,</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token comment">// 求 d 模 n 的逆，n 为正整数</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">int</span> a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>q<span class="token punctuation">,</span>r<span class="token punctuation">,</span>u<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>v<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>t<span class="token punctuation">;</span><span class="token comment">//a 为被除数，b 为除数，q 为商</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    a<span class="token operator">=</span>n<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    b<span class="token operator">=</span><span class="token punctuation">(</span>d<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">(</span>d<span class="token operator">%</span>n<span class="token punctuation">)</span><span class="token operator">:</span><span class="token operator">-</span><span class="token punctuation">(</span>d<span class="token operator">%</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 规定正负数 mod（n）都取正；</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">while</span><span class="token punctuation">(</span>b<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        q<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>a<span class="token operator">/</span>b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        r<span class="token operator">=</span>a<span class="token operator">-</span>b<span class="token operator">*</span>q<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        a<span class="token operator">=</span>b<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        b<span class="token operator">=</span>r<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        t<span class="token operator">=</span>v<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        v<span class="token operator">=</span>u<span class="token operator">-</span>q<span class="token operator">*</span>v<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        u<span class="token operator">=</span>t<span class="token punctuation">;</span><span class="token comment">// 把每次没有进行运算的 v 的值给 u</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token comment">// 辗转相除，直到余数 b=0，跳出循环</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">!=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>u<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    	cout<span class="token operator">&lt;&lt;</span>u<span class="token operator">+</span>n<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>	<span class="token keyword">else</span></pre></td></tr><tr><td data-num="25"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span>u<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>	<span class="token keyword">int</span> d<span class="token punctuation">,</span>n<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>		cin<span class="token operator">>></span>d<span class="token operator">>></span>n<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>		<span class="token function">mod_invese</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>统计分析攻击仿射密码 :</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 统计分析攻击仿射密码 </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 考虑使用优先级队列将数量出现最多的两个字母取出来 </span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">//priority_queue&lt;int,vector&lt;int>,greater&lt;int> >q;// 升序 </span></pre></td></tr><tr><td data-num="6"></td><td><pre>priority_queue<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">,</span>less<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token operator">></span>q<span class="token punctuation">;</span><span class="token comment">// 降序 </span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">const</span> <span class="token keyword">int</span> maxn<span class="token operator">=</span><span class="token number">1e4</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">int</span> num<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">char</span> str<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>str2<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">int</span>  <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>	<span class="token keyword">int</span> c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// 与 26 互素的所有元素 </span></pre></td></tr><tr><td data-num="13"></td><td><pre>	<span class="token keyword">int</span> inverse<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>	<span class="token keyword">int</span> temp<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>	<span class="token function">memset</span><span class="token punctuation">(</span>inverse<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>inverse<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="16"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">12</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>		inverse<span class="token punctuation">[</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span>temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>	<span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="20"></td><td><pre>	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>		<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>			q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>		<span class="token punctuation">&#125;</span><span class="token comment">// 将队列清空 </span></pre></td></tr><tr><td data-num="26"></td><td><pre>		<span class="token function">memset</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token string">"Please enter your ciphertext:"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>		cin<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span>maxn<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 原始密文 </span></pre></td></tr><tr><td data-num="29"></td><td><pre>		<span class="token keyword">int</span> len<span class="token operator">=</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>	    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>	    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token comment">// 为方便操作，将密文转换成小写字母 </span></pre></td></tr><tr><td data-num="33"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>		str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token char">'a'</span><span class="token operator">-</span><span class="token char">'A'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>	    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>	    <span class="token keyword">else</span> str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>	    <span class="token keyword">if</span><span class="token punctuation">(</span>str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span>str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>	    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>		num<span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">(</span>str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>		<span class="token punctuation">&#125;</span><span class="token comment">// 统计每个字母出现的次数（不考虑大小写） </span></pre></td></tr><tr><td data-num="42"></td><td><pre>	    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="44"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>			<span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre>			q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>		<span class="token punctuation">&#125;</span><span class="token comment">// 把字母出现次数压到队列里进行自动排序 </span></pre></td></tr><tr><td data-num="48"></td><td><pre>		<span class="token keyword">int</span> test1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="49"></td><td><pre>        <span class="token keyword">int</span> test2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>		test1<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 出现最多的次数 </span></pre></td></tr><tr><td data-num="51"></td><td><pre>		q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="52"></td><td><pre>		test2<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 出现次多的次数 </span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token comment">//		q.pop();</span></pre></td></tr><tr><td data-num="54"></td><td><pre>		<span class="token keyword">int</span> a<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>		<span class="token keyword">int</span> b<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="57"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>			<span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>test1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="59"></td><td><pre>			<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>				a<span class="token operator">=</span>i<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>			<span class="token punctuation">&#125;</span><span class="token comment">// 找出出现次数最多字母偏移量 </span></pre></td></tr><tr><td data-num="62"></td><td><pre>			<span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>test2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="63"></td><td><pre>			<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>				b<span class="token operator">=</span>i<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>			<span class="token punctuation">&#125;</span><span class="token comment">// 找出出现次数次多字母偏移量 </span></pre></td></tr><tr><td data-num="66"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>		<span class="token keyword">int</span> k1<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>b<span class="token operator">-</span>a<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">7</span><span class="token operator">%</span><span class="token number">26</span><span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span><span class="token comment">//+26 防止出现结果出现负数 </span></pre></td></tr><tr><td data-num="68"></td><td><pre>		<span class="token keyword">int</span> k2<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token operator">-</span><span class="token number">4</span><span class="token operator">*</span>k1<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="69"></td><td><pre>		<span class="token keyword">int</span> m<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 计算每个字母偏移量放到数组 m [maxn] 中 </span></pre></td></tr><tr><td data-num="70"></td><td><pre>	    <span class="token keyword">int</span> k3<span class="token operator">=</span>inverse<span class="token punctuation">[</span>k1<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 求出 k1 模逆 </span></pre></td></tr><tr><td data-num="71"></td><td><pre>	    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="72"></td><td><pre>	    <span class="token punctuation">&#123;</span>		</pre></td></tr><tr><td data-num="73"></td><td><pre>		m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>k3<span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token operator">-</span>k2<span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre><span class="token comment">//		cout&lt;&lt;(char)('A'+m);</span></pre></td></tr><tr><td data-num="75"></td><td><pre>	    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>	    cout<span class="token operator">&lt;&lt;</span><span class="token string">"******Decryption******"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="77"></td><td><pre>	    cout<span class="token operator">&lt;&lt;</span><span class="token string">"k1="</span><span class="token operator">&lt;&lt;</span>k1<span class="token operator">&lt;&lt;</span><span class="token string">","</span><span class="token operator">&lt;&lt;</span><span class="token string">"k2="</span><span class="token operator">&lt;&lt;</span>k2<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="78"></td><td><pre>    	cout<span class="token operator">&lt;&lt;</span><span class="token string">"The plaintext is:"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>     	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="80"></td><td><pre>    	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="82"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token char">'A'</span><span class="token operator">+</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="83"></td><td><pre>		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="84"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token char">'a'</span><span class="token operator">+</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>		<span class="token keyword">else</span></pre></td></tr><tr><td data-num="86"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>	    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>    	cout<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>	    cin<span class="token punctuation">.</span><span class="token function">ignore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="90"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="91"></td><td><pre>      <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="92"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>统计分析攻击仿射密码的优化 ：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 统计分析攻击仿射密码的优化 </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">//priority_queue&lt;int,vector&lt;int>,greater&lt;int> >q;// 升序 </span></pre></td></tr><tr><td data-num="5"></td><td><pre>priority_queue<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token punctuation">,</span>less<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token operator">></span>q<span class="token punctuation">;</span><span class="token comment">// 降序 </span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">const</span> <span class="token keyword">int</span> maxn<span class="token operator">=</span><span class="token number">1e4</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">int</span> num<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">char</span> str<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>str2<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">int</span>  <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token keyword">int</span> c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// 与 26 互素的所有元素 </span></pre></td></tr><tr><td data-num="12"></td><td><pre>	<span class="token keyword">int</span> inverse<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>	<span class="token keyword">int</span> temp<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>	<span class="token function">memset</span><span class="token punctuation">(</span>inverse<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>inverse<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="15"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">12</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>		inverse<span class="token punctuation">[</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">=</span>temp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>	<span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="19"></td><td><pre>	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>		<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>			q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>		<span class="token function">memset</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token string">"Please enter your ciphertext:"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>		cin<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>		<span class="token keyword">int</span> len<span class="token operator">=</span><span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>	    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>	    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>		str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token char">'a'</span><span class="token operator">-</span><span class="token char">'A'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>	    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>	    <span class="token keyword">else</span> str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>	    <span class="token keyword">if</span><span class="token punctuation">(</span>str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span>str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>	    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>		num<span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">(</span>str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token comment">//		count++;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>	    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>			<span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>			q<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>		<span class="token keyword">int</span> test1<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        <span class="token keyword">int</span> test2<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>		test1<span class="token operator">=</span>q<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>		<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>q<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="51"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>			q<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>		<span class="token keyword">int</span> a<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token comment">//		int b=0;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="57"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>			<span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span>test1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="59"></td><td><pre>			<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>				a<span class="token operator">=</span>i<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>			<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>		<span class="token keyword">int</span> m<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">11</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="65"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>		<span class="token keyword">int</span> k1<span class="token operator">=</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>	    <span class="token keyword">int</span> k3<span class="token operator">=</span>inverse<span class="token punctuation">[</span>k1<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>	    <span class="token keyword">int</span> k2<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token operator">-</span><span class="token number">4</span><span class="token operator">*</span>k1<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>	    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="70"></td><td><pre>	    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>		m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>k3<span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token operator">-</span>k2<span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token comment">//		cout&lt;&lt;(char)('A'+m);</span></pre></td></tr><tr><td data-num="73"></td><td><pre>	    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>	    cout<span class="token operator">&lt;&lt;</span><span class="token string">"******Decryption******"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>	    cout<span class="token operator">&lt;&lt;</span><span class="token string">"k1="</span><span class="token operator">&lt;&lt;</span>k1<span class="token operator">&lt;&lt;</span><span class="token string">","</span><span class="token operator">&lt;&lt;</span><span class="token string">"k2="</span><span class="token operator">&lt;&lt;</span>k2<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="76"></td><td><pre>    	cout<span class="token operator">&lt;&lt;</span><span class="token string">"The plaintext is:"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="77"></td><td><pre>     	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="78"></td><td><pre>    	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="80"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token char">'A'</span><span class="token operator">+</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="82"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token char">'a'</span><span class="token operator">+</span>m<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="83"></td><td><pre>		<span class="token keyword">else</span></pre></td></tr><tr><td data-num="84"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>	    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="86"></td><td><pre>    	cout<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>    	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>	    cin<span class="token punctuation">.</span><span class="token function">ignore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="90"></td><td><pre>      <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="91"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><blockquote><p>仿射密码在线解密测试文本：</p><p>Pu yfo of oin hvy ufa hrpkpyb, jlar ph hopkk py oin hvy oinan, svo jn jpkk klvbi rfan zfyupgnyo zlkr; pu ovayng of ufvyg iph fjy hilgfj, lmmafmaplon nhzlmn, oin hvy jpkk sn oiafvbi oin inlao,jlar nlzi mklzn snipyg oin zfayna; pu ly fvohoanozing mlkr zlyyfo ulkk svoonaukx, oiny zknyzing jlcpyb larh, bpcny mfjna; pu P zly’o ilcn sapbio hrpkn, po jpkk ulzn of oin hvyhipyn, lyg hvyhipyn hrpkn ofbnoina, py uvkk skffr.</p></blockquote><h2 id="part-ii-维吉尼亚密码"><a class="anchor" href="#part-ii-维吉尼亚密码">#</a> PART Ⅱ 维吉尼亚密码</h2><p>加密变换：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 维吉尼亚的加密 </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token keyword">const</span> <span class="token keyword">int</span> maxn<span class="token operator">=</span><span class="token number">1e4</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token keyword">char</span> s1<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>s2<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//s1 是密钥，s2 是明文 </span></pre></td></tr><tr><td data-num="10"></td><td><pre>	<span class="token function">memset</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token function">memset</span><span class="token punctuation">(</span>s2<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"Please enter your plaintext:"</span><span class="token punctuation">;</span>	</pre></td></tr><tr><td data-num="13"></td><td><pre>	cin<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>s2<span class="token punctuation">,</span>maxn<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//s2 明文 </span></pre></td></tr><tr><td data-num="14"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"Please enter your key:"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>	cin<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span>maxn<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 密钥 </span></pre></td></tr><tr><td data-num="16"></td><td><pre>	<span class="token keyword">int</span> len1<span class="token operator">=</span><span class="token function">strlen</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>	<span class="token keyword">int</span> len2<span class="token operator">=</span><span class="token function">strlen</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">//	cout&lt;&lt;len1&lt;&lt;" "&lt;&lt;len2&lt;&lt;endl; </span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token comment">// 密钥全部改小写，方便移位计数 </span></pre></td></tr><tr><td data-num="20"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len1<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="21"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>		s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token char">'a'</span><span class="token operator">-</span><span class="token char">'A'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>	<span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment">//s2 加密的过程如下	</span></pre></td></tr><tr><td data-num="26"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"******Encryption******"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"The ciphertext is:"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>	<span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len2<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token comment">// 如果遇到空格，就不能用密钥 </span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token comment">// 通过 j 来进行标记 </span></pre></td></tr><tr><td data-num="33"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>			s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token char">'A'</span><span class="token operator">+</span><span class="token punctuation">(</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>s1<span class="token punctuation">[</span>j<span class="token operator">%</span>len1<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token char">'A'</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span>	</pre></td></tr><tr><td data-num="36"></td><td><pre>			j<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>			s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token char">'a'</span><span class="token operator">+</span><span class="token punctuation">(</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>s1<span class="token punctuation">[</span>j<span class="token operator">%</span>len1<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span>		</pre></td></tr><tr><td data-num="41"></td><td><pre>			j<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>	cin<span class="token punctuation">.</span><span class="token function">ignore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>解密变换：</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 维吉尼亚密码的解密 </span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token keyword">const</span> <span class="token keyword">int</span> maxn<span class="token operator">=</span><span class="token number">1e4</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token keyword">char</span> s1<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">,</span>s2<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//s1 是密钥，s2 是密文 </span></pre></td></tr><tr><td data-num="10"></td><td><pre>	<span class="token function">memset</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token function">memset</span><span class="token punctuation">(</span>s2<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"Please enter your ciphertext:"</span><span class="token punctuation">;</span>	</pre></td></tr><tr><td data-num="13"></td><td><pre>	cin<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>s2<span class="token punctuation">,</span>maxn<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"Please enter your key:"</span><span class="token punctuation">;</span> </pre></td></tr><tr><td data-num="15"></td><td><pre>	cin<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span>maxn<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>	<span class="token keyword">int</span> len1<span class="token operator">=</span><span class="token function">strlen</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>	<span class="token keyword">int</span> len2<span class="token operator">=</span><span class="token function">strlen</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len1<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">// 密钥全部改小写 </span></pre></td></tr><tr><td data-num="19"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>		s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token char">'a'</span><span class="token operator">-</span><span class="token char">'A'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>	<span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment">//s2 解密的过程如下</span></pre></td></tr><tr><td data-num="24"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"******Decryption******"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>	cout<span class="token operator">&lt;&lt;</span><span class="token string">"The plaintext is:"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>	</pre></td></tr><tr><td data-num="26"></td><td><pre>	<span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len2<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">// 如果遇到空格，就不能用密钥 </span></pre></td></tr><tr><td data-num="30"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>			s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token char">'A'</span><span class="token operator">+</span><span class="token punctuation">(</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'A'</span><span class="token operator">-</span><span class="token punctuation">(</span>s1<span class="token punctuation">[</span>j<span class="token operator">%</span>len1<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>			j<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>			s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token char">'a'</span><span class="token operator">+</span><span class="token punctuation">(</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token operator">-</span><span class="token punctuation">(</span>s1<span class="token punctuation">[</span>j<span class="token operator">%</span>len1<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>			j<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>	cin<span class="token punctuation">.</span><span class="token function">ignore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>维吉尼亚密码无密钥破解:</p><figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 维吉尼亚密码无密钥破解</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;bits/stdc++.h></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> <span class="token keyword">int</span> maxn<span class="token operator">=</span><span class="token number">1e4</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">//int key[maxn];</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">char</span> s2<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// 字母出现的频率 </span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">double</span> p<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">0.082</span><span class="token punctuation">,</span><span class="token number">0.015</span><span class="token punctuation">,</span><span class="token number">0.028</span><span class="token punctuation">,</span><span class="token number">0.043</span><span class="token punctuation">,</span><span class="token number">0.127</span><span class="token punctuation">,</span><span class="token number">0.022</span><span class="token punctuation">,</span><span class="token number">0.02</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token number">0.061</span><span class="token punctuation">,</span><span class="token number">0.07</span><span class="token punctuation">,</span><span class="token number">0.002</span><span class="token punctuation">,</span><span class="token number">0.008</span><span class="token punctuation">,</span><span class="token number">0.04</span><span class="token punctuation">,</span><span class="token number">0.024</span><span class="token punctuation">,</span><span class="token number">0.067</span><span class="token punctuation">,</span><span class="token number">0.075</span><span class="token punctuation">,</span><span class="token number">0.019</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token number">0.001</span><span class="token punctuation">,</span><span class="token number">0.06</span><span class="token punctuation">,</span><span class="token number">0.063</span><span class="token punctuation">,</span><span class="token number">0.091</span><span class="token punctuation">,</span><span class="token number">0.028</span><span class="token punctuation">,</span><span class="token number">0.01</span><span class="token punctuation">,</span><span class="token number">0.023</span><span class="token punctuation">,</span><span class="token number">0.001</span><span class="token punctuation">,</span><span class="token number">0.02</span><span class="token punctuation">,</span><span class="token number">0.001</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">// 密钥长度以及密钥的计算 </span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">void</span> <span class="token function">secretkeylen</span><span class="token punctuation">(</span><span class="token keyword">char</span> c<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>	</pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>	<span class="token keyword">int</span> klen<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">// 密钥长度</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">int</span> clen<span class="token operator">=</span><span class="token function">strlen</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 密文长度</span></pre></td></tr><tr><td data-num="16"></td><td><pre>	<span class="token keyword">int</span> key<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 存放密钥 </span></pre></td></tr><tr><td data-num="17"></td><td><pre>	<span class="token keyword">int</span> num<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>	<span class="token function">memset</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	</pre></td></tr><tr><td data-num="19"></td><td><pre>	<span class="token function">memset</span><span class="token punctuation">(</span>s2<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	     	</pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre> 	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">float</span> IC<span class="token punctuation">[</span>clen<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">// 重合指数</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token function">memset</span><span class="token punctuation">(</span>IC<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>IC<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>	<span class="token keyword">float</span> avgIC<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// 平均重合指数</span></pre></td></tr><tr><td data-num="25"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>klen<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">// 统计分组字母个数 	</span></pre></td></tr><tr><td data-num="26"></td><td><pre>	<span class="token punctuation">&#123;</span>	</pre></td></tr><tr><td data-num="27"></td><td><pre>	    <span class="token function">memset</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 盛放字母个数的数组</span></pre></td></tr><tr><td data-num="28"></td><td><pre>	    <span class="token comment">// 密钥长度等于分成的组数</span></pre></td></tr><tr><td data-num="29"></td><td><pre>		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token operator">&lt;</span>clen<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>		<span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="33"></td><td><pre>		num<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'A'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>		<span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="37"></td><td><pre>		num<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>		<span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token keyword">float</span> e<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// 重合指数的值 </span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token keyword">int</span> L<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">// 子串密文长度 </span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        L<span class="token operator">+=</span>num<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="46"></td><td><pre>        L<span class="token operator">*=</span><span class="token punctuation">(</span>L<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 分母 </span></pre></td></tr><tr><td data-num="47"></td><td><pre>	    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">// 分组计算重合指数 IC </span></pre></td></tr><tr><td data-num="48"></td><td><pre>	    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>	    <span class="token keyword">if</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="50"></td><td><pre>	    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>		e<span class="token operator">=</span>e<span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>num<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span><span class="token punctuation">(</span>num<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>L<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>		IC<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>e<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>	<span class="token punctuation">&#125;</span> </pre></td></tr><tr><td data-num="56"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>klen<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="57"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>	avgIC<span class="token operator">+=</span>IC<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>	avgIC<span class="token operator">/=</span>klen<span class="token punctuation">;</span><span class="token comment">// 求 IC 的平均值  </span></pre></td></tr><tr><td data-num="61"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>avgIC<span class="token operator">>=</span><span class="token number">0.065</span><span class="token punctuation">)</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token comment">// 判断退出条件，重合指数的平均值是否大于 0.065 </span></pre></td></tr><tr><td data-num="62"></td><td><pre>   	<span class="token keyword">else</span> klen<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token comment">//   	cout&lt;&lt;"密钥长度为:"&lt;&lt;klen&lt;&lt;endl;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>    cout<span class="token operator">&lt;&lt;</span><span class="token string">"密钥长度为:"</span><span class="token operator">&lt;&lt;</span>klen<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>klen<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">// 统计分组字母个数 </span></pre></td></tr><tr><td data-num="67"></td><td><pre>	<span class="token punctuation">&#123;</span>	</pre></td></tr><tr><td data-num="68"></td><td><pre>	<span class="token keyword">int</span> g<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// 密文移动 g 个位置 </span></pre></td></tr><tr><td data-num="69"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> t<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>t<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span>t<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">// 控制移动位数在 0-25 个 </span></pre></td></tr><tr><td data-num="70"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>		<span class="token keyword">float</span> x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// 拟重合指数 	</span></pre></td></tr><tr><td data-num="72"></td><td><pre>		<span class="token function">memset</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 盛放字母个数的数组</span></pre></td></tr><tr><td data-num="73"></td><td><pre>		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token operator">&lt;</span>clen<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="74"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>			<span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="76"></td><td><pre>			<span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="77"></td><td><pre>			num<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'A'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="78"></td><td><pre>			<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>			<span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="80"></td><td><pre>			<span class="token punctuation">&#123;</span> </pre></td></tr><tr><td data-num="81"></td><td><pre>			num<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token operator">*</span>klen<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>			<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="83"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="84"></td><td><pre>	    <span class="token keyword">int</span> L<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>	    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token comment">// 子串密文长度</span></pre></td></tr><tr><td data-num="86"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>			L<span class="token operator">+=</span>num<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>			x<span class="token operator">=</span>x<span class="token operator">+</span>p<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">*</span>num<span class="token punctuation">[</span><span class="token punctuation">(</span>k<span class="token operator">+</span>g<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>	    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="90"></td><td><pre>	    <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">/</span>L<span class="token operator">></span><span class="token number">0.055</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="91"></td><td><pre>	    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="92"></td><td><pre>	        key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>g<span class="token punctuation">;</span><span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="93"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="94"></td><td><pre>	    <span class="token keyword">else</span> g<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="95"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="96"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="97"></td><td><pre><span class="token comment">//	cout&lt;&lt;"加密密钥为:";</span></pre></td></tr><tr><td data-num="98"></td><td><pre>	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>klen<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="99"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="100"></td><td><pre>		s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token keyword">char</span><span class="token punctuation">(</span><span class="token char">'a'</span><span class="token operator">+</span>key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="102"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="103"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="104"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="105"></td><td><pre>	<span class="token keyword">char</span> c<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="106"></td><td><pre>	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="107"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="108"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token string">"Please enter your ciphertext:"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>		cin<span class="token punctuation">.</span><span class="token function">getline</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>maxn<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="110"></td><td><pre><span class="token comment">//		int len2=strlen (s2);// 密钥</span></pre></td></tr><tr><td data-num="111"></td><td><pre>		<span class="token function">secretkeylen</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="112"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token string">"加密密钥为:"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="113"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span>s2<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="114"></td><td><pre>		<span class="token keyword">int</span> len1<span class="token operator">=</span><span class="token function">strlen</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 密文 </span></pre></td></tr><tr><td data-num="115"></td><td><pre>		<span class="token keyword">int</span> len2<span class="token operator">=</span><span class="token function">strlen</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 密钥 </span></pre></td></tr><tr><td data-num="116"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token string">"******Decryption******"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="117"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span><span class="token string">"The plaintext is:"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>	</pre></td></tr><tr><td data-num="118"></td><td><pre>		<span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="119"></td><td><pre>		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len1<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="120"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="121"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'A'</span><span class="token operator">&amp;&amp;</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'Z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="122"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="123"></td><td><pre>			c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token char">'A'</span><span class="token operator">+</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'A'</span><span class="token operator">-</span><span class="token punctuation">(</span>s2<span class="token punctuation">[</span>j<span class="token operator">%</span>len2<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="124"></td><td><pre>			j<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="125"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="126"></td><td><pre>		<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">>=</span><span class="token char">'a'</span><span class="token operator">&amp;&amp;</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token char">'z'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="127"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="128"></td><td><pre>			c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token char">'a'</span><span class="token operator">+</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token operator">-</span><span class="token punctuation">(</span>s2<span class="token punctuation">[</span>j<span class="token operator">%</span>len2<span class="token punctuation">]</span><span class="token operator">-</span><span class="token char">'a'</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="129"></td><td><pre>			j<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="130"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="131"></td><td><pre>		cout<span class="token operator">&lt;&lt;</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="132"></td><td><pre>		<span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span>len1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="133"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="134"></td><td><pre>			cout<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="135"></td><td><pre>			cout<span class="token operator">&lt;&lt;</span><span class="token string">"Please enter your ciphertext:"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="136"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="137"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="138"></td><td><pre>	cin<span class="token punctuation">.</span><span class="token function">ignore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="139"></td><td><pre><span class="token comment">//	cout&lt;&lt;endl;</span></pre></td></tr><tr><td data-num="140"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="141"></td><td><pre>	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="142"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><blockquote><p>维吉尼亚在线测试文本:</p><p>BZGTNPMMCGZFPUWJCUIGRWXPFNLHZCKOAPGLKYJNRAQFIUYRAVGNPANUMDQOAHMWTGJDXGOMPJPTKAAVZIUIWKVTUCWBWNFWDFUMPJWPMQGPTNWXTSDPLPMWJAXUHHXWPFXXGVAPFNTXVFKOYIRBOQJHCBVWVFYCGQFGUSUBDWVIYATJGTBNDKGHCTMTWIUEFJITVUGJHHIMUVJICUWYQWYGGUWPUUCWIFGWUANILKPHDKOSPJTTWJQOJHXLBJAPZHVQWPDYPGLLGDBCHTGIZCCMEGVIIJLIFFBHSMEGUJHRXBOQUBDNASPEUCWNGWSNWXTSDPLPMWJAIUHUMWPSYCTUWFBMIAMKVBNTDMQNBVDKILQSSDYVWVXIGDQFIBHSLEAVDBXGOLGDBCHTGIZVNFQFKTNGRWXUDCTGKWCOXIXKZPPFDZG</p></blockquote><div class="tags"><a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%9A%84%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0/" rel="tag"><i class="ic i-tag"></i> 密码学的代码实现</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2023-09-08 15:20:06" itemprop="dateModified" datetime="2023-09-08T15:20:06+08:00">2023-09-08</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="Small Town 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="Small Town 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Small Town <i class="ic i-at"><em>@</em></i>踏雪无痕</li><li class="link"><strong>本文链接：</strong> <a href="https://crazyzer0.github.io/2023/09/07/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%8B%E7%BE%8E-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/" title="密码学之美 -- 古典密码">https://crazyzer0.github.io/2023/09/07/密码学之美-古典密码/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"></div><div class="item right"><a href="/2023/09/08/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%8B%E7%BE%8E-%E5%BA%8F%E5%88%97%E5%AF%86%E7%A0%81/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giph4wqtg4j20zk0m8x6p.jpg" title="密码学之美--序列密码"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 密码学</span><h3>密码学之美--序列密码</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">古典密码概述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E6%9B%BF%E6%8D%A2%E5%AF%86%E7%A0%81"><span class="toc-number">1.1.</span> <span class="toc-text">单表替换密码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#i-%E5%9F%BA%E4%BA%8E%E5%AF%86%E9%92%A5%E7%9A%84%E5%8D%95%E8%A1%A8%E4%BB%A3%E6%8D%A2%E5%AF%86%E7%A0%81"><span class="toc-number">1.1.1.</span> <span class="toc-text">Ⅰ 基于密钥的单表代换密码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">安全性分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ii-%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81affine-cipher%E7%BA%BF%E6%80%A7%E5%90%8C%E4%BD%99%E5%AF%86%E7%A0%81"><span class="toc-number">1.1.2.</span> <span class="toc-text">Ⅱ 仿射密码（affine cipher：线性同余密码）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90-2"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">安全性分析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E6%9B%BF%E6%8D%A2%E5%AF%86%E7%A0%81"><span class="toc-number">1.2.</span> <span class="toc-text">多表替换密码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#vigen%C3%A8re%E5%AF%86%E7%A0%81"><span class="toc-number">1.2.1.</span> <span class="toc-text">Vigenère 密码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E6%80%A7%E5%88%86%E6%9E%90-3"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">安全性分析</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E4%BB%BB%E5%8A%A1%E7%82%B9"><span class="toc-number">2.</span> <span class="toc-text">密码课程设计任务点</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#c%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-number">3.</span> <span class="toc-text">C++ 代码实现</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#part-i-%E5%8D%95%E8%A1%A8%E6%9B%BF%E6%8D%A2%E5%AF%86%E7%A0%81-%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81"><span class="toc-number">3.1.</span> <span class="toc-text">PART Ⅰ 单表替换密码 -- 仿射密码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E5%8F%98%E6%8D%A2"><span class="toc-number">3.1.1.</span> <span class="toc-text">加密变换：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86%E5%8F%98%E6%8D%A2"><span class="toc-number">3.1.2.</span> <span class="toc-text">解密变换：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9A%B4%E5%8A%9B%E7%A9%B7%E4%B8%BE%E7%A0%B4%E8%A7%A3"><span class="toc-number">3.1.3.</span> <span class="toc-text">暴力穷举破解：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1%E5%88%86%E6%9E%90%E6%94%BB%E5%87%BB%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81"><span class="toc-number">3.1.4.</span> <span class="toc-text">统计分析攻击仿射密码：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E%E5%85%AC%E5%BC%8F%E7%9A%84%E6%8E%A8%E5%AF%BC"><span class="toc-number">3.1.4.1.</span> <span class="toc-text">关于公式的推导：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1%E5%88%86%E6%9E%90%E6%94%BB%E5%87%BB%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81%E7%9A%84%E4%BC%98%E5%8C%96"><span class="toc-number">3.1.5.</span> <span class="toc-text">统计分析攻击仿射密码的优化：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#part-ii-%E5%A4%9A%E8%A1%A8%E6%9B%BF%E6%8D%A2%E5%AF%86%E7%A0%81-%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81"><span class="toc-number">3.2.</span> <span class="toc-text">PART Ⅱ 多表替换密码 -- 维吉尼亚密码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E5%8F%98%E6%8D%A2-2"><span class="toc-number">3.2.1.</span> <span class="toc-text">加密变换：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86%E5%8F%98%E6%8D%A2-2"><span class="toc-number">3.2.2.</span> <span class="toc-text">解密变换：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81%E6%97%A0%E5%AF%86%E9%92%A5%E7%A0%B4%E8%A7%A3"><span class="toc-number">3.2.3.</span> <span class="toc-text">维吉尼亚密码无密钥破解:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%99%84%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-number">4.</span> <span class="toc-text">附源代码：</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#part-i-%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81"><span class="toc-number">4.1.</span> <span class="toc-text">PART Ⅰ 仿射密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#part-ii-%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81"><span class="toc-number">4.2.</span> <span class="toc-text">PART Ⅱ 维吉尼亚密码</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/2023/09/07/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%8B%E7%BE%8E-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/" rel="bookmark" title="密码学之美--古典密码">密码学之美--古典密码</a></li><li><a href="/2023/09/08/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%8B%E7%BE%8E-%E5%BA%8F%E5%88%97%E5%AF%86%E7%A0%81/" rel="bookmark" title="密码学之美--序列密码">密码学之美--序列密码</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Small Town" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Small Town</p><div class="description" itemprop="description">2023 & 北京 & 学习笔记</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">2</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">1</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">1</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3lvdXJuYW1l" title="https:&#x2F;&#x2F;github.com&#x2F;yourname"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;yourname"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPXlvdXJpZA==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;yourid"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20veW91cm5hbWU=" title="https:&#x2F;&#x2F;weibo.com&#x2F;yourname"><i class="ic i-weibo"></i></span> <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;about.me&#x2F;yourname"><i class="ic i-address-card"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/" title="分类于 密码学">密码学</a></div><span><a href="/2023/09/07/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%8B%E7%BE%8E-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/" title="密码学之美--古典密码">密码学之美--古典密码</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/" title="分类于 密码学">密码学</a></div><span><a href="/2023/09/08/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%8B%E7%BE%8E-%E5%BA%8F%E5%88%97%E5%AF%86%E7%A0%81/" title="密码学之美--序列密码">密码学之美--序列密码</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-Small Town"></i> </span><span class="author" itemprop="copyrightHolder">Small Town @ Small Town</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">22k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">20 分钟</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2023/09/07/密码学之美-古典密码/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->